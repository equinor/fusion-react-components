import { Meta, Story, Canvas, ArgsTable, Description } from '@storybook/addon-docs';
import { ChangeLog, PackageInfo, StoryExample } from '../../components';
import { PersonListItem } from '@equinor/fusion-react-person/src';

<Meta title="Data/Person/List Item" component={PersonListItem} />

<PackageInfo pkg={require('@equinor/fusion-react-person/package.json')} />

# PersonListItem

## Properties/Attributes

Name                      | Type                            | Default                         | Description
------------------------- | -----------------------------   | -----------------------------   | -----------
`azureId`                 | `string`                        | `/`                             | Unique Azure ID for every person `required`
`upn`                     | `string`                        | `/`                             | Unique person email address.
`dataSource`              | `CardData**`                    | `/`                             | Custom data for avatar.
`size`                    | `PersonItemSize*`               | `medium`                        | Size of elements of the card.
`clickable`               | `boolean`                       | `false`                         | Is component clickable?

---

`slot` available for additional icons or button

---
\*  `PersonItemSize` is exported by `fwc-avatar`.
```ts
type PersonItemSize = 'small' | 'medium' | 'large';
```

## Example Usage

```tsx
import { PersonItemSize } from '@equinor/fusion-react-person';

// azureId
<PersonItemSize azureId="8a5f03ff-1875-4bf3-a3f4-aef1264e3bcc" />

// upn
<PersonItemSize upn="email@equinor.com" />

// dataSource
<PersonItemSize dataSource={{
        name: 'First Last Name (Bouvet ASA)',
        pictureSrc: 'https://i.imgur.com/GcZeeXX.jpeg',
        accountType: "Consultant",
        jobTitle: 'X-Bouvet ASA (PX)',
        department: 'FOIT CON PDP',
    }} />
```

## Example

<StoryExample storyId="examples-person-person-list-item--component" showSource />

## Person Provider

In order to use components such as PersonAvatar, PersonCard and PersonListItem you need to have **PersonProvider** wrapper.

### Properties/Attributes

Name                      | Type                            | Description
------------------------- | -----------------------------   | -----------
`resolve`                 | `PersonResolver*`               | Person resolver for a provider. See [`fwc-person-provider`](https://github.com/equinor/fusion-web-components/tree/main/packages/person/src/person-provider) 

### Methods

| Name                                   | Return Type                     | Description
| -------------------------------------- | -----------------------------   | -----------------------------
| `getListItemDetailsByAzureId(azureId)` | `ListItemData**`                | Returns `ListItemData` for unique AuzureId.
| `getListItemDetailsByUpn(upn)`         | `ListItemData**`                | Returns `ListItemData` for unique AuzureId.

---

\*  `PersonResolver` is exported by `fwc-person-provider`.
```ts
interface PersonResolver {
    getPresence: (azureId: string) => Promise<PersonPresence> | PersonPresence;
    getDetails: (azureId: string) => Promise<PersonDetails> | PersonDetails;
    getImageByAzureId: (azureId: string) => Promise<AvatarData> | AvatarData;
    getImageByUpn: (upn: string) => Promise<AvatarData> | AvatarData;
    getCardDetailsByAzureId: (azureId: string) => Promise<CardData> | CardData;
    getCardDetailsByUpn: (upn: string) => Promise<CardData> | CardData;
    getListItemDetailsByAzureId: (azureId: string) => Promise<ListItemData> | ListItemData;
    getListItemDetailsByUpn: (upn: string) => Promise<ListItemData> | ListItemData;
}
```

`PersonPresence` is exported by `fwc-person-provider`.
```ts
type PersonPresence = {
    azureId: string;
    availability: PersonAvailability;
};

```
\*\*\*  `PersonDetails` is exported by `fwc-person-provider`.
```ts
type PersonDetails = {
    azureId: string;
    name?: string;
    pictureSrc?: string;
    jobTitle?: string;
    department?: string;
    mail?: string;
    company?: string;
    mobilePhone?: string;
    accountType?: PersonAccountType;
    officeLocation?: string;
}

type Position = {
    id: string;
    name: string;
    project: {
        id: string;
        name: string;
    };
}

type Manager = {
    azureUniqueId: string;
    name?: string;
    pictureSrc?: string;
    department?: string;
    accountType?: PersonAccountType;
}
```

## Changelog

<ChangeLog changelogs={require('@equinor/fusion-react-person/CHANGELOG.md')} />
