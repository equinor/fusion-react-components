import { Meta, Story, Canvas, ArgsTable, Description } from '@storybook/addon-docs';
import { ChangeLog, PackageInfo, StoryExample } from '../../components';
import { PersonCard, PersonAvatar } from '@equinor/fusion-react-person/src';

<Meta title="Data/Person/Avatar" component={PersonAvatar} />

<PackageInfo pkg={require('@equinor/fusion-react-person/package.json')} />

# PersonAvatar

## Properties/Attributes

In order for component to work, `azureId`, `upn` or `dataSource` is **required**.

Name                      | Type                            | Default                         | Description
------------------------- | -----------------------------   | -----------------------------   | -----------
`azureId`                 | `string`                        | `/`                             | Unique Azure ID for every person.
`upn`                     | `string`                        | `/`                             | Unique person email address.
`dataSource`              | `AvatarData**`                  | `/`                             | Custom data for avatar.
`size`                    | `AvatarSize*`                   | `medium`                        | Size of the avatar. See [`fusion-wc-avatar`](https://github.com/equinor/fusion-web-components/tree/main/packages/avatar).
`clickable`               | `boolean`                       | `false`                         | Set to true to activate visual ripple effects to indicate that the avatar is clickable.
`showFloatingOn`          | `'click' | 'hover'`             | `/`                             | Show person card on click or hover over the avatar.
`disabled`                | `boolean`                       | `false`                         | Set to true to display the avatar as disabled. 


## Example Usage

```tsx
import { PersonAvatar } from '@equinor/fusion-react-person';

// azureId
<PersonAvatar azureId="8a5f03ff-1875-4bf3-a3f4-aef1264e3bcc" />

// upn
<PersonAvatar upn="email@equinor.com" />

// dataSource
<PersonAvatar dataSource={{
    pictureSrc: 'https://picture.com/picture-source.jpg',
    name: 'Justin Case',
  }} />
```

## Example

<StoryExample storyId="examples-person-person-avatar--component" showSource />

## Person Provider

**! IMPORTANT ! **
In order to use components such as PersonAvatar or PersonCard you **DON'T** need to have **PersonProvider** wrapped, it will be provided by the framework.

### Properties/Attributes

Name                      | Type                            | Description
------------------------- | -----------------------------   | -----------
`resolve`                 | `PersonResolver*`               | Person resolver for a provider. See [`fwc-person-provider`](https://github.com/equinor/fusion-web-components/tree/main/packages/person/src/person-provider) 

### Methods

| Name                          | Return Type                     | Description
| ----------------------------- | -----------------------------   | -----------------------------
| `getImageByAzureId(azureId)`  | `AvatarData**`                  | Returns `AvatarData` for unique AuzureId.
| `getImageByUpn(upn)`          | `AvatarData**`                  | Returns `AvatarData` for unique email address.
| `getPresence(azureId)`        | `PersonPresence***`             | Returns `PersonPresence` for unique AuzureId.
| `getDetails(azureId)`         | `PersonDetails****`             | Returns `PersonDetails` for unique AuzureId.

### Example Usage

```tsx
import { PersonProvider, PersonAvatar } from '@equinor/fusion-react-person';

  <PersonProvider resolve={resolver}>
    <PersonAvatar azureId {...props} />
  </PersonProvider>
```

\*  `PersonResolver` is exported by `fwc-person-provider`.
```ts
interface PersonResolver {
    getImageByAzureId: (azureId: string) => Promise<AvatarData> | AvatarData;
    getImageByUpn: (upn: string) => Promise<AvatarData> | AvatarData;
    getPresence: (azureId: string) => Promise<PersonPresence> | PersonPresence;
    getDetails: (azureId: string) => Promise<PersonDetails> | PersonDetails;
}
```

\*\* `AvatarData` is exported by person avatar task.
```ts
type AvatarData = RequiredAndOptionalPick<PersonDetails, 'name' | 'pictureSrc', 'accountType'>
```

\*\*\* `PersonPresence` is exported by `fwc-person-provider`.
```ts
type PersonPresence = {
    azureId: string;
    availability: PersonAvailability;
};

```
\*\*\*\*  `PersonDetails` is exported by `fwc-person-provider`.
```ts
type PersonDetails = {
    azureId: string;
    name?: string;
    pictureSrc?: string;
    jobTitle?: string;
    department?: string;
    mail?: string;
    company?: string;
    mobilePhone?: string;
    accountType?: PersonAccountType;
    officeLocation?: string;
}
```

## Changelog

<ChangeLog changelogs={require('@equinor/fusion-react-person/CHANGELOG.md')} />
