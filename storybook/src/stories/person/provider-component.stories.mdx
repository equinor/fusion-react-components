import { Meta, Story, Canvas, ArgsTable, Description } from '@storybook/addon-docs';
import { ChangeLog, PackageInfo, StoryExample } from '../../components';
import { PersonCard, PersonProvider } from '@equinor/fusion-react-person/src';

<Meta title="Data/Person/Provider" component={PersonProvider} />

<PackageInfo pkg={require('@equinor/fusion-react-person/package.json')} />

# PersonProvider

**PersonProvider** is a component that allows you to create a ***custom resolver for all person components***.

In order to create a custom provider you need to have a **resolver**.

## Properties/Attributes

Name                      | Type                            | Description
------------------------- | -----------------------------   | -----------
`resolve`                 | `PersonResolver*`               | Person resolver for a provider. See [`person-provider`](https://github.com/equinor/fusion-react-components/blob/main/packages/person/src/PersonProvider.tsx) 

## Example Usage

```tsx
import { PersonProvider, PersonAvatar } from '@equinor/fusion-react-person';

  // create resolver for provider
  const useResolver = () => {
      return {
          // you need to provide all the data
          getImageByAzureId: async (azureId) => {
            return await Promise.resolve({
              azureId,
              name,
              pictureSrc,
              accountType,
            }) as AvatarData;
          },
          getImageByUpn: async (upn) => {
            return await Promise.resolve({
              name,
              pictureSrc,
              accountType,
            }) as AvatarData;
          },
          // ...and add the rest
          getCardDetailsByAzureId,
          getCardDetailsByUpn,
          getListItemDetailsByAzureId,
          getListItemDetailsByUpn,
      };
  }

  // use resolver for a provider with person components, example. PersonAvatar
  <PersonProvider resolve={useResolver()}> 
    <PersonAvatar {...props}>
  </PersonProvider>

```

## PersonResolver

\*  `PersonResolver` is exported by `fwc-person-provider`.
```ts
interface PersonResolver {
    getImageByAzureId: (azureId: string) => Promise<AvatarData> | AvatarData;
    getImageByUpn: (upn: string) => Promise<AvatarData> | AvatarData;
    getCardDetailsByAzureId: (azureId: string) => Promise<CardData> | CardData;
    getCardDetailsByUpn: (upn: string) => Promise<CardData> | CardData;
    getListItemDetailsByAzureId: (azureId: string) => Promise<ListItemData> | ListItemData;
    getListItemDetailsByUpn: (upn: string) => Promise<ListItemData> | ListItemData;
}
```

### AvatarData
`AvatarData` is exported type used by [person avatar](?path=/docs/data-person-avatar--page).
```ts
type AvatarData = RequiredAndOptionalPick<PersonDetails, 'name' | 'pictureSrc', 'accountType'>
```

### CardData
`CardData` is exported type used by [person card](?path=/docs/data-person-card--page).
```ts
type CardData = RequiredAndOptionalPick<
  PersonDetails,
  'name' | 'pictureSrc', 'department' | 'jobTitle' | 'accountType' | 'mail' | 'mobilePhone' | 'positions' | 'manager'
>
```

### ListItemData
`ListItemData` is exported type used by [person list item](?path=/docs/data-person-list-item--page).
```ts
type ListItemData = RequiredAndOptionalPick<PersonDetails, 'name' | 'accountType', 'department' | 'pictureSrc'>;
```

`PersonDetails` is exported by `fwc-person-provider`.
```ts
type PersonDetails = {
    azureId: string;
    name?: string;
    pictureSrc?: string;
    jobTitle?: string;
    department?: string;
    mail?: string;
    companies?: Company[];
    mobilePhone?: string;
    accountType?: PersonAccountType;
    officeLocation?: string;
}

type Company = {
    id: string;
    name: string;
}

type Position = {
    id: string;
    name: string;
    project: {
        id: string;
        name: string;
    };
}

type Manager = {
    azureUniqueId: string;
    name?: string;
    pictureSrc?: string;
    department?: string;
    accountType?: PersonAccountType;
}
```

## Changelog

<ChangeLog
  changelogs={{
    react: require('@equinor/fusion-react-person/CHANGELOG.md'),
  }}
/>
