import { useRef, useState, useCallback } from 'react';
import { Meta, Story, Canvas } from '@storybook/addon-docs';
import Menu from '@equinor/fusion-react-menu';
import { ListItem } from '@equinor/fusion-react-list';
import Button from '@equinor/fusion-react-button';

export const DefaultTemplate = (props) => {
  const buttonRef = useRef();
  return (
    <div style={{ display: 'flex', justifyContent: 'center', height: '200px', position: 'relative' }}>
      <div style={{ position: 'relative' }}>
        <Button ref={buttonRef}>Menu</Button>
        <Menu {...props} anchor={buttonRef.current} open>
          <ListItem>Item 1</ListItem>
          <ListItem>Item 2</ListItem>
          <ListItem>Item 3</ListItem>
        </Menu>
      </div>
    </div>
  );
};

export const ActivatableTemplate = (props) => {
  const buttonRef = useRef();
  return (
    <div style={{ display: 'flex', justifyContent: 'center', height: '200px', position: 'relative' }}>
      <div style={{ position: 'relative' }}>
        <Button ref={buttonRef}>Menu</Button>
        <Menu {...props} anchor={buttonRef.current} open>
          <ListItem>Item 1</ListItem>
          <ListItem selected activated>
            Item 2
          </ListItem>
          <ListItem>Item 3</ListItem>
        </Menu>
      </div>
    </div>
  );
};

export const MultiTemplate = (props) => {
  const buttonRef = useRef();
  return (
    <div style={{ display: 'flex', justifyContent: 'center', height: '200px', position: 'relative' }}>
      <div style={{ position: 'relative' }}>
        <Button ref={buttonRef}>Menu</Button>
        <Menu {...props} anchor={buttonRef.current} open>
          <ListItem>Item 1</ListItem>
          <ListItem selected activated>
            Item 2
          </ListItem>
          <ListItem selected activated>
            Item 3
          </ListItem>
        </Menu>
      </div>
    </div>
  );
};

export const CornerTemplate = (props) => {
  const [open, setOpen] = useState(true);
  const buttonRef = useRef();
  const onClick = useCallback(() => {
    setOpen(true);
  }, [setOpen]);
  const menuCornerArray = [
    'TOP_LEFT',
    'TOP_RIGHT',
    'BOTTOM_LEFT',
    'BOTTOM_RIGHT',
    'TOP_START',
    'TOP_END',
    'BOTTOM_START',
    'BOTTOM_END',
  ];
  return (
    <>
      {menuCornerArray.map((corner) => (
        <div style={{ display: 'flex', justifyContent: 'center', height: '200px' }}>
          <div style={{ position: 'relative' }}>
            <Button ref={buttonRef} onClick={onClick}>
              Menu
            </Button>
            <Menu {...props} anchor={buttonRef.current} open={open} onClosed={() => setOpen(false)} corner={corner}>
              <ListItem>Item 1</ListItem>
              <ListItem>Item 2</ListItem>
              <ListItem>Item 3</ListItem>
            </Menu>
          </div>
        </div>
      ))}
    </>
  );
};

export const DefaultFocusTemplate = (props) => {
  const [open, setOpen] = useState(true);
  const buttonRef = useRef();
  const onClick = useCallback(() => {
    setOpen(true);
  }, [setOpen]);
  const menuCornerArray = [
    'TOP_LEFT',
    'TOP_RIGHT',
    'BOTTOM_LEFT',
    'BOTTOM_RIGHT',
    'TOP_START',
    'TOP_END',
    'BOTTOM_START',
    'BOTTOM_END',
  ];
  return (
    <>
      {menuCornerArray.map((corner) => (
        <div style={{ display: 'flex', justifyContent: 'center', height: '200px', position: 'relative' }}>
          <div style={{ position: 'relative' }}>
            <Button ref={buttonRef} onClick={onClick}>
              Menu
            </Button>
            <Menu {...props} anchor={buttonRef.current} open={open} onClosed={() => setOpen(false)} corner={corner}>
              <ListItem>Item 1</ListItem>
              <ListItem>Item 2</ListItem>
              <ListItem>Item 3</ListItem>
              <ListItem>Item 4</ListItem>
            </Menu>
          </div>
        </div>
      ))}
    </>
  );
};

export const GroupedTemplate = (props) => {
  const [open, setOpen] = useState();
  const buttonRef = useRef();
  const onClick = useCallback(() => {
    setOpen(true);
  }, [setOpen]);
  return (
    <div style={{ display: 'flex', justifyContent: 'center', height: '200px', position: 'relative' }}>
      <div style={{ position: 'relative' }}>
        <Button ref={buttonRef} onClick={onClick}>
          Menu
        </Button>
        <Menu {...props} anchor={buttonRef.current} open={open} onClosed={() => setOpen(false)}>
          <ListItem>Item 1</ListItem>
          <ListItem>Item 2</ListItem>
          <ListItem>Item 3</ListItem>
          <ListItem>Item 4</ListItem>
        </Menu>
      </div>
    </div>
  );
};

<Meta title="Snapshots/Menu" parameters={{ chromatic: { disableSnapshot: false } }} />

### Activatable

<Story name="Activatable" args={{ activatable: true }}>
  {ActivatableTemplate.bind({})}
</Story>

### Multi (Activatable)

<Story name="Multi" args={{ multi: true, activatable: true }}>
  {MultiTemplate.bind({})}
</Story>

### Corner

<Story name="Corner" args={{}}>
  {CornerTemplate.bind({})}
</Story>

### Default Focus

<Story name="DefaultFocus" args={{}}>
  {DefaultFocusTemplate.bind({})}
</Story>

### Grouped

<Story name="Grouped" args={{}}>
  {GroupedTemplate.bind({})}
</Story>
